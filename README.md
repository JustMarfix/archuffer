# Archuffer

> [!NOTE]  
> Archuffer - учебный проект по предмету в университете.


## Quick start

Archuffer - архиватор со сжатием на основе кодов Хаффмана.

Архиватор умеет упаковывать файлы и директории (рекурсивно) в архивы, а также распаковывать эти архивы, воссоздавая изначальную структуру каталогов,
а также сохраняя права (rwx) файла, а также owner UID и GID соответственно. Ниже доступны примеры использования CLI.

Архивировать файлы `a1.txt`, `a2.txt`, а также содержимое директории `my_files` в архив `data.ar`:
```
python3 main.py archive a1.txt a2.txt my_files -o data.ar
```

Разархивировать архив `data.ar` в директорию `result`:
```
python3 main.py unarchive data.ar -o result
```

По умолчанию утилита показывает прогресс архивирования (в stdout). Отключить это поведение можно флагом `-P/--no-progress`.

Archuffer, помимо исходного кода, также поставляется с исполняемым файлом, скомпилированным
с помощью [Nuitka](https://github.com/Nuitka/Nuitka) - Py2C компилятора.
Вы можете скомпилировать проект локально, запустив команду:


```bash
$ nuitka \
  --onefile \
  --standalone \         
  --lto=yes \
  --python-flag=no_site \
  --python-flag=isolated \
  --clang \
  main.py
```

## Алгоритм

Перед кодированием Хаффманом используется сжатие на основе LZ77 (Lempel-Ziv 1977). Зачем это делается? Чтобы к статическому сжатию добавить сжатие на основе частот.

Пример:

Если на вход подаётся текст `abcdabcdabcdabcd` (частоты `a: 4, b: 4, c: 4, d: 4` соответственно), то поскольку все частоты одинаковы, Хаффман кодировал бы 2 бита на символ.

Lempel-Ziv на такой строке даст `abcd (4, 12)`. После LZ энтропия очевидно падает, и Хаффман получает входные данные, где одни
символы встречаются сильно чаще чем другие - идеальные входные данные для него.
